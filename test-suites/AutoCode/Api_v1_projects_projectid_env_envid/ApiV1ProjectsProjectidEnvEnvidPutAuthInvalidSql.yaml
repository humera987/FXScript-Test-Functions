---
parent: "Api_v1_projects_projectid_env_envid"
name: "ApiV1ProjectsProjectidEnvEnvidPutAuthInvalidSql"
description: null
authors:
- "FX Bot"
type: "SUITE"
init: []
path: "/api/v1/projects/{projectId}/env/{envId}"
endpoint: "/api/v1/projects/{{@Random}}/env/{{@Random}}"
method: "PUT"
auth: "Invalid_Auth_SQL"
headers:
- "Accept: application/json"
- "Content-Type: application/json"
testCases:
- id: 1
  body: "{\n  \"auths\" : [ {\n    \"accessTokenUri\" : \"{{@Random}}\",\n    \"authType\"\
    \ : \"BASIC\",\n    \"authorizationScheme\" : \"none\",\n    \"clientAuthenticationScheme\"\
    \ : \"form\",\n    \"clientId\" : \"{{@Random}}\",\n    \"clientSecret\" : \"\
    {{@Random}}\",\n    \"grantType\" : \"password\",\n    \"header_1\" : \"{{@Random}}\"\
    ,\n    \"header_2\" : \"{{@Random}}\",\n    \"header_3\" : \"{{@Random}}\",\n\
    \    \"id\" : \"\",\n    \"name\" : \"{{@Random}}\",\n    \"password\" : \"{{@Random}}\"\
    ,\n    \"preEstablishedRedirectUri\" : \"{{@Random}}\",\n    \"scope\" : \"{{@Random}}\"\
    ,\n    \"tokenName\" : \"{{@Random}}\",\n    \"useCurrentUri\" : false,\n    \"\
    userAuthorizationUri\" : \"{{@Random}}\",\n    \"username\" : \"{{@Faker.name.username}}\"\
    \n  } ],\n  \"baseUrl\" : \"{{@Random}}\",\n  \"createdBy\" : \"\",\n  \"createdDate\"\
    \ : \"\",\n  \"description\" : \"{{@XSSSQLInjections}}\",\n  \"id\" : \"\",\n\
    \  \"inactive\" : false,\n  \"modifiedBy\" : \"\",\n  \"modifiedDate\" : \"\"\
    ,\n  \"name\" : \"{{@Random}}\",\n  \"projectId\" : \"{{@Random}}\",\n  \"refId\"\
    \ : \"{{@Random}}\",\n  \"version\" : \"\"\n}"
  inactive: false
assertions:
- "@StatusCode == 401 OR @StatusCode == 403"
cleanup: []
severity: "Major"
category: "InvalidAuthSQL"
tags:
- "V1"
- "OWASP A1"
- "[PCI DSS 3.0] 6.5.1"
- "OTG-AUTHN-004"
- "FX Top 10 - API Vulnerability"
- "Non-Intrusive"
- "Injection"
inactive: false
policies:
  initExec: "Request"
  cleanupExec: "Request"
  logger: "DEBUG"
  timeoutSeconds: 300
  repeatOnFailure: 0
  repeat: 0
  repeatModule: "@MySQLTimeboundSQLInjections"
  repeatDelay: 0
autoGenerated: true
